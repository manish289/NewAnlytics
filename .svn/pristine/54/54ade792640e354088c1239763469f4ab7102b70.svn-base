package com.isource;

import java.lang.management.ManagementFactory;
import java.lang.management.MemoryMXBean;
import java.lang.management.MemoryUsage;

import org.apache.log4j.Logger;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.web.bind.annotation.CrossOrigin;

@CrossOrigin("*")
@SpringBootApplication
@EnableCaching
public class T247ApiAnalyticsApplication extends SpringBootServletInitializer {

	public static void main(String[] args) {
		SpringApplication.run(T247ApiAnalyticsApplication.class, args);
		
		Logger logger = Logger.getLogger(T247ApiAnalyticsApplication.class);
		
		 MemoryMXBean memBean = ManagementFactory.getMemoryMXBean() ;
		 MemoryUsage heapMemoryUsage = memBean.getHeapMemoryUsage();
		 logger.info("Max : "+heapMemoryUsage.getMax()); // max memory allowed for jvm -Xmx flag (-1 if isn't specified)
		 logger.info("given memory to JVM by OS : "+heapMemoryUsage.getCommitted()); // given memory to JVM by OS ( may fail to reach getMax, if there isn't more memory)
		 logger.info("Used : "+heapMemoryUsage.getUsed()); // used now by your heap
		 logger.info("Init : "+heapMemoryUsage.getInit());
		
		System.out.println("T247-Api-Analytics");
	}

	@Override
	protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
		return application.sources(T247ApiAnalyticsApplication.class);
	}
}
